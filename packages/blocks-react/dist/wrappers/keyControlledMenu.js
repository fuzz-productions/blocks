"use strict";var _extends=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},_createClass=function(){function n(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,o,t){return o&&n(e.prototype,o),t&&n(e,t),e}}();function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,o){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!o||"object"!=typeof o&&"function"!=typeof o?e:o}function _inherits(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}var React=require("react"),PropTypes=require("prop-types");function keyControlledMenu(e){var o=(_inherits(r,React.Component),_createClass(r,[{key:"componentDidUpdate",value:function(e){if(e.options!==this.props.options){for(var o=[],t=0;t<this.props.options.length;t++)o[t]=React.createRef();this.setState({optionsRefs:o})}}},{key:"onSelect",value:function(e,o){o.onClick?o.onClick(e):this.props.onChange&&this.props.onChange(o),this.props.close(e)}},{key:"onKeyDown",value:function(e){"Tab"===e.key&&this.props.isOpen?this.props.close():-1<["ArrowDown"," "].indexOf(e.key)&&!this.props.isOpen?(e.preventDefault(),this.props.open()):(-1<["ArrowDown","ArrowUp","Enter"," "].indexOf(e.key)&&e.preventDefault(),this.moveFocusUsingKey(e.key))}},{key:"onKeyUp",value:function(e,o){-1<["Enter"," "].indexOf(e.key)?this.onSelect(e,o):"Escape"===e.key&&this.props.close()}},{key:"onTriggerFocus",value:function(){this.setState({onFocusIdx:-1})}},{key:"moveFocusUsingKey",value:function(e){var o=this;this.setState({onFocusIdx:this.getFocusIndexAfterKeyPress(e)},function(){return o.focusOption(o.state.onFocusIdx)})}},{key:"getFocusIndexAfterKeyPress",value:function(e){if("ArrowDown"===e)return Math.min(this.state.onFocusIdx+1,this.props.options.length-1);if("ArrowUp"===e)return Math.max(this.state.onFocusIdx-1,0);for(var o=0;o<this.props.options.length;o++){var t=this.props.options[o];if(t.text&&t.text[0].toLowerCase()===e)return o}return this.state.onFocusIdx}},{key:"focusOption",value:function(e){if(!(e<0)){var o=this.state.optionsRefs[e].current;if(o)for(var t=0;t<o.childNodes.length;t++){var n=o.childNodes[t];if("function"==typeof n.focus){n.focus();break}}}}},{key:"render",value:function(){return React.createElement(e,_extends({},this.props,{optionsRefs:this.state.optionsRefs,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onSelect:this.onSelect,onTriggerFocus:this.onTriggerFocus}))}}]),r);function r(e){_classCallCheck(this,r);for(var o=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e)),t=[],n=0;n<o.props.options.length;n++)t[n]=React.createRef();return o.state={onFocusIdx:-1,optionsRefs:t},o.onSelect=o.onSelect.bind(o),o.onKeyDown=o.onKeyDown.bind(o),o.onKeyUp=o.onKeyUp.bind(o),o.onTriggerFocus=o.onTriggerFocus.bind(o),o}return o.propTypes={isOpen:PropTypes.bool,close:PropTypes.func.isRequired,options:PropTypes.arrayOf(PropTypes.shape({text:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),disabled:PropTypes.bool,value:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),href:PropTypes.string,element:PropTypes.node,key:PropTypes.string})),onChange:PropTypes.func},o.defaultProps={isOpen:!1,options:[],onChange:function(){}},o}module.exports=keyControlledMenu;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndyYXBwZXJzL2tleUNvbnRyb2xsZWRNZW51LmpzeCJdLCJuYW1lcyI6WyJSZWFjdCIsInJlcXVpcmUiLCJQcm9wVHlwZXMiLCJrZXlDb250cm9sbGVkTWVudSIsIldyYXBwZWRDb21wb25lbnQiLCJHZW5lcmljRHJvcGRvd24iLCJfaW5oZXJpdHMiLCJDb21wb25lbnQiLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJ2YWx1ZSIsInByZXZQcm9wcyIsIm9wdGlvbnMiLCJ0aGlzIiwicHJvcHMiLCJvcHRpb25zUmVmcyIsImkiLCJsZW5ndGgiLCJjcmVhdGVSZWYiLCJzZXRTdGF0ZSIsImUiLCJvcHRpb24iLCJvbkNsaWNrIiwib25DaGFuZ2UiLCJjbG9zZSIsImlzT3BlbiIsImluZGV4T2YiLCJwcmV2ZW50RGVmYXVsdCIsIm9wZW4iLCJtb3ZlRm9jdXNVc2luZ0tleSIsIm9uU2VsZWN0Iiwib25Gb2N1c0lkeCIsImtleU5hbWUiLCJfdGhpczIiLCJnZXRGb2N1c0luZGV4QWZ0ZXJLZXlQcmVzcyIsImZvY3VzT3B0aW9uIiwic3RhdGUiLCJNYXRoIiwibWluIiwibWF4IiwidGV4dCIsInRvTG93ZXJDYXNlIiwiaWR4Iiwib3B0aW9uUmVmIiwiY3VycmVudCIsImNoaWxkTm9kZXMiLCJjaGlsZCIsImZvY3VzIiwiY3JlYXRlRWxlbWVudCIsIl9leHRlbmRzIiwib25LZXlEb3duIiwib25LZXlVcCIsIm9uVHJpZ2dlckZvY3VzIiwiX2NsYXNzQ2FsbENoZWNrIiwiX3RoaXMiLCJfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIsIl9fcHJvdG9fXyIsIk9iamVjdCIsImdldFByb3RvdHlwZU9mIiwiY2FsbCIsImJpbmQiLCJwcm9wVHlwZXMiLCJib29sIiwiZnVuYyIsImlzUmVxdWlyZWQiLCJhcnJheU9mIiwic2hhcGUiLCJvbmVPZlR5cGUiLCJzdHJpbmciLCJudW1iZXIiLCJkaXNhYmxlZCIsImhyZWYiLCJlbGVtZW50Iiwibm9kZSIsImRlZmF1bHRQcm9wcyIs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QjdDLFNBQVVyQixVQUFVNkQsTUFHdEIxRCxFQUFnQnFFLGFBQWUsQ0FDN0JqRCxRQUFRLEVBQ1JiLFFBQVMsR0FDVFcsU0FBVSxjQUdMbEIsRUFHVHNFLE9BQU9DLFFBQVV6RSIsImZpbGUiOiJ3cmFwcGVycy9rZXlDb250cm9sbGVkTWVudS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFJlYWN0ID0gcmVxdWlyZSgncmVhY3QnKTtcbmNvbnN0IFByb3BUeXBlcyA9IHJlcXVpcmUoJ3Byb3AtdHlwZXMnKTtcblxuZnVuY3Rpb24ga2V5Q29udHJvbGxlZE1lbnUoV3JhcHBlZENvbXBvbmVudCkge1xuICBjbGFzcyBHZW5lcmljRHJvcGRvd24gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICBzdXBlcihwcm9wcyk7XG5cbiAgICAgIGNvbnN0IG9wdGlvbnNSZWZzID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucHJvcHMub3B0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBvcHRpb25zUmVmc1tpXSA9IFJlYWN0LmNyZWF0ZVJlZigpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICBvbkZvY3VzSWR4OiAtMSxcbiAgICAgICAgb3B0aW9uc1JlZnNcbiAgICAgIH07XG5cbiAgICAgIHRoaXMub25TZWxlY3QgPSB0aGlzLm9uU2VsZWN0LmJpbmQodGhpcyk7XG4gICAgICB0aGlzLm9uS2V5RG93biA9IHRoaXMub25LZXlEb3duLmJpbmQodGhpcyk7XG4gICAgICB0aGlzLm9uS2V5VXAgPSB0aGlzLm9uS2V5VXAuYmluZCh0aGlzKTtcbiAgICAgIHRoaXMub25UcmlnZ2VyRm9jdXMgPSB0aGlzLm9uVHJpZ2dlckZvY3VzLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgICAgaWYgKHByZXZQcm9wcy5vcHRpb25zICE9PSB0aGlzLnByb3BzLm9wdGlvbnMpIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uc1JlZnMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByb3BzLm9wdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBvcHRpb25zUmVmc1tpXSA9IFJlYWN0LmNyZWF0ZVJlZigpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBvcHRpb25zUmVmcyB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBvblNlbGVjdChlLCBvcHRpb24pIHtcbiAgICAgIGlmIChvcHRpb24ub25DbGljaykge1xuICAgICAgICBvcHRpb24ub25DbGljayhlKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5wcm9wcy5vbkNoYW5nZSkge1xuICAgICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKG9wdGlvbik7XG4gICAgICB9XG4gICAgICB0aGlzLnByb3BzLmNsb3NlKGUpO1xuICAgIH1cblxuICAgIG9uS2V5RG93bihlKSB7XG4gICAgICBpZiAoZS5rZXkgPT09ICdUYWInICYmIHRoaXMucHJvcHMuaXNPcGVuKSB7XG4gICAgICAgIHRoaXMucHJvcHMuY2xvc2UoKTtcbiAgICAgIH0gZWxzZSBpZiAoWydBcnJvd0Rvd24nLCAnICddLmluZGV4T2YoZS5rZXkpID4gLTEgJiYgIXRoaXMucHJvcHMuaXNPcGVuKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5wcm9wcy5vcGVuKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoWydBcnJvd0Rvd24nLCAnQXJyb3dVcCcsICdFbnRlcicsICcgJ10uaW5kZXhPZihlLmtleSkgPiAtMSkgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLm1vdmVGb2N1c1VzaW5nS2V5KGUua2V5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBvbktleVVwKGUsIG9wdGlvbikge1xuICAgICAgaWYgKFsnRW50ZXInLCAnICddLmluZGV4T2YoZS5rZXkpID4gLTEpIHtcbiAgICAgICAgdGhpcy5vblNlbGVjdChlLCBvcHRpb24pO1xuICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIG9uVHJpZ2dlckZvY3VzKCkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIG9uRm9jdXNJZHg6IC0xXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBtb3ZlRm9jdXNVc2luZ0tleShrZXlOYW1lKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgb25Gb2N1c0lkeDogdGhpcy5nZXRGb2N1c0luZGV4QWZ0ZXJLZXlQcmVzcyhrZXlOYW1lKVxuICAgICAgfSwgKCkgPT4gdGhpcy5mb2N1c09wdGlvbih0aGlzLnN0YXRlLm9uRm9jdXNJZHgpKVxuICAgIH1cblxuICAgIGdldEZvY3VzSW5kZXhBZnRlcktleVByZXNzKGtleU5hbWUpIHtcbiAgICAgIGlmIChrZXlOYW1lID09PSAnQXJyb3dEb3duJykgcmV0dXJuIE1hdGgubWluKHRoaXMuc3RhdGUub25Gb2N1c0lkeCArIDEsIHRoaXMucHJvcHMub3B0aW9ucy5sZW5ndGggLSAxKTtcbiAgICAgIGlmIChrZXlOYW1lID09PSAnQXJyb3dVcCcpIHJldHVybiBNYXRoLm1heCh0aGlzLnN0YXRlLm9uRm9jdXNJZHggLSAxLCAwKTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5wcm9wcy5vcHRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHRoaXMucHJvcHMub3B0aW9uc1tpXTtcbiAgICAgICAgaWYgKG9wdGlvbi50ZXh0ICYmIG9wdGlvbi50ZXh0WzBdLnRvTG93ZXJDYXNlKCkgPT09IGtleU5hbWUpIHJldHVybiBpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuc3RhdGUub25Gb2N1c0lkeDtcbiAgICB9XG5cbiAgICBmb2N1c09wdGlvbihpZHgpIHtcbiAgICAgIGlmIChpZHggPCAwKSByZXR1cm47XG4gICAgICBjb25zdCBvcHRpb25SZWYgPSB0aGlzLnN0YXRlLm9wdGlvbnNSZWZzW2lkeF0uY3VycmVudDtcbiAgICAgIGlmIChvcHRpb25SZWYpIHtcbiAgICAgICAgLy8gcmVmIGlzIHRvIHRoZSBsaSBpdGVtIHRoYXQgY29udGFpbnMgdGhlIGRyb3Bkb3duIGVsZW1lbnRzXG4gICAgICAgIC8vIHNlYXJjaCBmb3IgYSBmb2N1c2FibGUgY2hpbGRcbiAgICAgICAgLy8gKHBhcnRpY3VsYXJseSBpbXBvcnRhbnQgZm9yIGN1c3RvbSBlbGVtZW50cylcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvcHRpb25SZWYuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IGNoaWxkID0gb3B0aW9uUmVmLmNoaWxkTm9kZXNbaV07XG4gICAgICAgICAgaWYgKHR5cGVvZiBjaGlsZC5mb2N1cyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2hpbGQuZm9jdXMoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxXcmFwcGVkQ29tcG9uZW50XG4gICAgICAgICAgey4uLnRoaXMucHJvcHN9XG4gICAgICAgICAgb3B0aW9uc1JlZnM9e3RoaXMuc3RhdGUub3B0aW9uc1JlZnN9XG4gICAgICAgICAgb25LZXlEb3duPXt0aGlzLm9uS2V5RG93bn1cbiAgICAgICAgICBvbktleVVwPXt0aGlzLm9uS2V5VXB9XG4gICAgICAgICAgb25TZWxlY3Q9e3RoaXMub25TZWxlY3R9XG4gICAgICAgICAgb25UcmlnZ2VyRm9jdXM9e3RoaXMub25UcmlnZ2VyRm9jdXN9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIEdlbmVyaWNEcm9wZG93bi5wcm9wVHlwZXMgPSB7XG4gICAgaXNPcGVuOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBjbG9zZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICBvcHRpb25zOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgdGV4dDogUHJvcFR5cGVzLm9uZU9mVHlwZShbXG4gICAgICAgIFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICAgIFByb3BUeXBlcy5udW1iZXJcbiAgICAgIF0pLFxuICAgICAgZGlzYWJsZWQ6IFByb3BUeXBlcy5ib29sLFxuICAgICAgdmFsdWU6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1xuICAgICAgICBQcm9wVHlwZXMuc3RyaW5nLFxuICAgICAgICBQcm9wVHlwZXMubnVtYmVyXG4gICAgICBdKSxcbiAgICAgIGhyZWY6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICBlbGVtZW50OiBQcm9wVHlwZXMubm9kZSxcbiAgICAgIGtleTogUHJvcFR5cGVzLnN0cmluZ1xuICAgIH0pKSxcbiAgICBvbkNoYW5nZTogUHJvcFR5cGVzLmZ1bmNcbiAgfTtcblxuICBHZW5lcmljRHJvcGRvd24uZGVmYXVsdFByb3BzID0ge1xuICAgIGlzT3BlbjogZmFsc2UsXG4gICAgb3B0aW9uczogW10sXG4gICAgb25DaGFuZ2U6ICgpID0+IHt9XG4gIH07XG5cbiAgcmV0dXJuIEdlbmVyaWNEcm9wZG93bjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBrZXlDb250cm9sbGVkTWVudTtcbiJdfQ==
